/* CANONICAL v5 — Full Framework (Scoped: .esheets-worksheet) — 2026-02-15 */

/**
 * ESHEETS v5 Core Styles (Generic)
 * 
 * Must work site-wide without affecting other elements.
 * All rules MUST be scoped under .esheets-worksheet
 */

/* --- Base Scoping --- */
.esheets-worksheet {
  font-family: system-ui, -apple-system, sans-serif;
  line-height: 1.6;
  color: #212529;
  font-size: 1.1rem;
  /* Improved readability base */
  width: 100%;
  max-width: 1000px;
  /* Wider layout */
  margin: 0 auto;
}

.esheets-worksheet * {
  box-sizing: border-box;
}

/* --- Score Displays (Top/Bottom) --- */
.esheets-worksheet [data-esheets-score] {
  font-weight: 600;
  color: #495057;
  font-size: 1.2rem;
}

.esheets-worksheet .esheets-scorebar {
  padding: 0.75rem 1.25rem;
  background-color: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  text-align: center;
  margin: 1.5rem 0;
}

/* --- Submission Bar (Bottom Control Panel) --- */
.esheets-worksheet .esheets-submission-bar {
  margin-top: 3rem;
  padding: 2rem;
  background-color: #f8f9fa;
  border-top: 2px solid #e9ecef;
  border-radius: 6px;
  text-align: center;
}

.esheets-worksheet .esheets-submission-bar .esheets-btn-group {
  display: flex;
  justify-content: center;
  gap: 1.5rem;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

/* --- Identity Bar --- */
.esheets-worksheet .esheets-identity-bar {
  display: flex;
  gap: 1.5rem;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.esheets-worksheet .esheets-identity-bar>div {
  display: flex;
  align-items: center;
}

.esheets-worksheet .esheets-identity-bar label {
  font-weight: bold;
  margin-right: 0.75rem;
}

/* --- Buttons (Scoped System) --- */

/* Base Button - Increased Sizing */
.esheets-worksheet .es-btn,
.esheets-worksheet .esheets-btn {
  font-family: inherit;
  font-size: 1.1rem;
  padding: 0.6rem 1.2rem;
  cursor: pointer;
  border: 1px solid transparent;
  border-radius: 6px;
  background-color: #e9ecef;
  color: #212529;
  transition: all 0.2s ease-in-out;
  line-height: 1.5;
  display: inline-block;
  text-align: center;
  text-decoration: none;
  vertical-align: middle;
  user-select: none;
}

/* Base Hover */
.esheets-worksheet .es-btn:hover:not(:disabled),
.esheets-worksheet .esheets-btn:hover:not(:disabled) {
  background-color: #dde2e6;
  text-decoration: none;
}

/* Base Focus */
.esheets-worksheet .es-btn:focus,
.esheets-worksheet .esheets-btn:focus {
  outline: 0;
  box-shadow: 0 0 0 0.25rem rgba(111, 66, 193, 0.25);
}

/* Primary Variant (Brand Purple) */
.esheets-worksheet .es-btn-primary,
.esheets-worksheet .esheets-btn-primary {
  background-color: #6f42c1;
  color: white;
  border-color: #6f42c1;
}

.esheets-worksheet .es-btn-primary:hover:not(:disabled),
.esheets-worksheet .esheets-btn-primary:hover:not(:disabled) {
  background-color: #5a32b1;
  border-color: #532da8;
}

.esheets-worksheet .es-btn-primary:focus,
.esheets-worksheet .esheets-btn-primary:focus {
  box-shadow: 0 0 0 0.25rem rgba(111, 66, 193, 0.5);
}

/* Secondary Variant */
.esheets-worksheet .es-btn-secondary,
.esheets-worksheet .esheets-btn-secondary {
  background-color: #6c757d;
  color: white;
  border-color: #6c757d;
}

.esheets-worksheet .es-btn-secondary:hover:not(:disabled),
.esheets-worksheet .esheets-btn-secondary:hover:not(:disabled) {
  background-color: #5a6268;
  border-color: #545b62;
}

.esheets-worksheet .es-btn-secondary:focus,
.esheets-worksheet .esheets-btn-secondary:focus {
  box-shadow: 0 0 0 0.25rem rgba(130, 138, 145, 0.5);
}

/* Small Variant */
.esheets-worksheet .es-btn-small {
  padding: 0.35rem 0.75rem;
  font-size: 1rem;
  line-height: 1.5;
  border-radius: 4px;
}

/* Disabled State */
.esheets-worksheet .es-btn:disabled,
.esheets-worksheet .es-btn.disabled,
.esheets-worksheet .esheets-btn:disabled {
  opacity: 0.65;
  cursor: not-allowed;
  box-shadow: none;
}

/* --- Confirmation UI (In-page) --- */
.esheets-worksheet .esheets-confirm-ui {
  margin-top: 1.5rem;
  padding: 1.5rem;
  background: #fff3cd;
  /* Warning yellow background */
  border: 1px solid #ffeeba;
  border-radius: 6px;
  color: #856404;
  animation: esheets-fade-in 0.3s ease-out;
}

.esheets-worksheet .esheets-confirm-ui p {
  margin: 0 0 1.5rem 0;
  font-weight: 500;
  font-size: 1.1rem;
}

/* --- Submission Summary --- */
.esheets-worksheet .esheets-summary {
  margin-top: 1.5rem;
  font-size: 1rem;
  color: #495057;
  border-top: 1px solid #dee2e6;
  padding-top: 1rem;
}

.esheets-worksheet .esheets-summary div {
  margin: 0.5rem 0;
}

/* --- Locked / Correct Inputs --- */
.esheets-worksheet input:disabled {
  background-color: #e9ecef;
  color: #495057;
  cursor: not-allowed;
  border-color: #ced4da;
}

/* --- Teacher Panel -- */
.esheets-worksheet .esheets-teacher-panel {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem;
  margin-top: 2rem;
  background-color: #fff3cd;
  /* Distinct yellow background */
  border: 1px solid #ffeeba;
  border-radius: 4px;
}

.esheets-worksheet .esheets-teacher-panel .es-tp-header {
  font-weight: bold;
  color: #856404;
}

.esheets-worksheet .esheets-teacher-panel .es-tp-actions {
  display: flex;
  gap: 0.5rem;
}

.esheets-worksheet .esheets-teacher-panel button {
  font-size: 0.9em;
  padding: 0.4rem 0.8rem;
}

/* --- Utility Animations --- */
@keyframes esheets-fade-in {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* --- Per-Question UI (Subtle/Teacher-friendly) --- */

/* Question Row Layout */
.esheets-worksheet .es-q-row {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 1.5rem;
  font-size: 1.1rem;
}

/* Styled Input - Increased Sizing */
.esheets-worksheet .es-input {
  display: inline-block;
  padding: 0.5rem 0.75rem;
  font-size: 1.1rem;
  font-family: inherit;
  line-height: 1.5;
  color: #495057;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ced4da;
  border-radius: 4px;
  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
  min-width: 5em;
}

.esheets-worksheet .es-input:focus {
  color: #495057;
  background-color: #fff;
  border-color: #bfaee3;
  outline: 0;
  box-shadow: 0 0 0 0.25rem rgba(111, 66, 193, 0.25);
}

.esheets-worksheet .es-input:disabled {
  background-color: #e9ecef;
  opacity: 1;
}

/* Outline Button */
.esheets-worksheet .es-btn-outline {
  color: #6c757d;
  background-color: transparent;
  background-image: none;
  border-color: #6c757d;
  padding: 0.4rem 0.8rem;
  /* Slightly larger click target */
}

.esheets-worksheet .es-btn-outline:hover:not(:disabled) {
  color: #fff;
  background-color: #6c757d;
  border-color: #6c757d;
}

.esheets-worksheet .es-btn-outline:focus,
.esheets-worksheet .es-btn-outline:active {
  box-shadow: 0 0 0 0.25rem rgba(108, 117, 125, 0.5);
}

.esheets-worksheet .es-btn-outline:disabled {
  color: #6c757d;
  background-color: transparent;
}

/* Status Pill */
.esheets-worksheet .es-pill {
  display: inline-block;
  padding: 0.35em 0.75em;
  font-size: 85%;
  font-weight: 700;
  line-height: 1;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: 10rem;
}

.esheets-worksheet .es-pill-correct {
  color: #155724;
  background-color: #d4edda;
  border: 1px solid #c3e6cb;
}

.esheets-worksheet .es-pill-wrong {
  color: #721c24;
  background-color: #f8d7da;
  border: 1px solid #f5c6cb;
}

/* Feedback Layout */
.esheets-worksheet .es-feedback {
  margin-left: 0.75rem;
  font-weight: 500;
  font-size: 1rem;
}

.esheets-worksheet .es-muted {
  color: #6c757d;
}

/* --- Identity Input States --- */

.esheets-worksheet .es-input.es-invalid {
  border-color: #dc3545;
}

.esheets-worksheet .es-input.es-invalid:focus {
  border-color: #dc3545;
  box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
}

.esheets-worksheet .es-input.es-readonly {
  background-color: #f3f0fa;
  /* Light purple tint */
  cursor: text;
}

.esheets-worksheet .es-input.es-readonly:focus {
  box-shadow: none;
  border-color: #ced4da;
}

/* --- Print Styles --- */
@media print {

  /* HIDE Ghost/Theme Elements */
  figure.gh-article-image,
  figure.kg-embed-card,
  figure.kg-card,
  div.gh-comments,
  footer.gh-foot,
  /* Targeted Ghost/Casper elements */
  .gh-canvas>figure,
  .gh-canvas>header,
  /* Member discussion blocks */
  .gh-comments-box,
  #ghost-comments-root {
    display: none !important;
  }

  /* Hide typical interactive worksheet elements */
  .esheets-worksheet .esheets-submission-bar,
  .esheets-worksheet button,
  .esheets-worksheet .es-btn,
  .esheets-worksheet .check-button {
    display: none !important;
  }

  /* Teacher Panel: Default HIDDEN */
  .esheets-worksheet .esheets-teacher-panel {
    display: none !important;
  }

  /* Teacher Panel: VISIBLE if teacher mode is ON */
  :root.esheets-teacher .esheets-worksheet .esheets-teacher-panel {
    display: flex !important;
    border: none;
    background: none;
    padding: 0;
    margin: 0 0 1rem 0;
    /* Adjusted for top position */
  }

  /* When printing in teacher mode, hide the actions but show the "Teacher Mode" label */
  :root.esheets-teacher .esheets-worksheet .esheets-teacher-panel .es-tp-actions {
    display: none !important;
  }

  :root.esheets-teacher .esheets-worksheet .esheets-teacher-panel .es-tp-header {
    display: block !important;
    font-size: 1.25em;
    text-align: center;
    width: 100%;
    margin-bottom: 1rem;
    color: #000;
  }

  /* Force revealed answers to print clearly */
  .esheets-worksheet .es-input.es-revealed {
    border-color: #000 !important;
    background-color: #fff !important;
    color: #000 !important;
    font-weight: bold;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Ensure rows don't break awkwardly */
  .esheets-worksheet .es-q-row {
    break-inside: avoid;
    page-break-inside: avoid;
  }

  /* Print Name Line */
  .es-print-name-line {
    display: block !important;
    text-align: center;
    margin-bottom: 2rem;
    font-size: 1.2rem;
    font-family: sans-serif;
  }

  .esheets-worksheet {
    border: none !important;
    background: white !important;
    width: 100% !important;
    max-width: none !important;
    font-size: 12pt;
  }

  /* Remove Identity Bar inputs for print cleanliness, or keep them? 
     Usually teachers want students to write name. 
     We can keep the structure but simplify borders if needed. 
     For now, let them print as is, but maybe hide if empty? 
     Let's leave them visible so students can verify identity.
  */
}

/* Screen styles for name line (Hidden) */
.es-print-name-line {
  display: none;
}

/* Teacher Panel Close Button */
.esheets-worksheet .esheets-teacher-panel .es-btn-outline {
  background: transparent;
  border: 1px solid #ccc;
  color: #666;
  padding: 2px 8px;
  font-size: 1.2em;
  line-height: 1;
}

.esheets-worksheet .esheets-teacher-panel .es-btn-outline:hover {
  background: #eee;
  color: #333;
  border-color: #999;
}